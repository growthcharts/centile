<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compact WHO growth standard • centile</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Compact WHO growth standard">
<meta property="og:description" content="centile">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">centile</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/compact.html">Compact WHO growth standard</a>
    </li>
    <li>
      <a href="../../articles/articles/rif.html">Reference Interchange Format (RIF)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/growthcharts/centile/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="compact_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compact WHO growth standard</h1>
                        <h4 class="author">Stef van Buuren</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/growthcharts/centile/blob/master/vignettes/articles/compact.Rmd"><code>vignettes/articles/compact.Rmd</code></a></small>
      <div class="hidden name"><code>compact.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/growthcharts/centile">centile</a></span><span class="op">)</span></code></pre></div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The WHO Growth Standards are published in the form of reference tables. The age grid and the numeric formatting in these tables is somewhat detailed. For example the height, BMI and weight references have 2026 age points, head circumference has 1857 age points and the weight-for-height references are stored in a table with 551 height points.</p>
<p>The tables may contain more detail than needed, potentially wasting resources and slowing down computing in time-critical applications. This section looks into the question whether we can reduce the number of rows in these tables without affecting precision of the calculations.</p>
<p>Let us study the height references for boys.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/load_reference.html">load_reference</a></span><span class="op">(</span><span class="st">"who_2006_hgt_male_"</span>, pkg <span class="op">=</span> <span class="st">"centile"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">full</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;        x     L     M      S</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 0          1  49.9 0.0380</span>
<span class="co">#&gt; 2 0.0027     1  50.1 0.0378</span>
<span class="co">#&gt; 3 0.0055     1  50.2 0.0378</span>
<span class="co">#&gt; 4 0.0082     1  50.4 0.0376</span>
<span class="co">#&gt; 5 0.011      1  50.6 0.0375</span>
<span class="co">#&gt; 6 0.0137     1  50.8 0.0374</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">full</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;       x     L     M      S</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  18.7     1  176. 0.0417</span>
<span class="co">#&gt; 2  18.8     1  176. 0.0416</span>
<span class="co">#&gt; 3  18.8     1  176. 0.0415</span>
<span class="co">#&gt; 4  18.9     1  177. 0.0414</span>
<span class="co">#&gt; 5  19       1  177. 0.0413</span>
<span class="co">#&gt; 6  19.1     1  177. 0.0413</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">full</span><span class="op">)</span>
<span class="co">#&gt; [1] 2026</span>

<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/make_agegrid.html">make_agegrid</a></span><span class="op">(</span><span class="st">"compact"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0000 0.0027 0.0055 0.0082 0.0110 0.0137</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="co">#&gt; [1] 18.5 19.0 19.5 20.0 20.5 21.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="co">#&gt; [1] 95</span></code></pre></div>
<p>The <code><a href="../../reference/make_agegrid.html">make_agegrid()</a></code> function creates an age grid that fairly detailed for the early ages, but less so for later ages. Can we reduce 2026 into 95 rows? We use linear interpolation to reduce the reference to 95 rows, as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">L</span>, x <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">x</span>, xout <span class="op">=</span> <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">y</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">M</span>, x <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">x</span>, xout <span class="op">=</span> <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">y</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">S</span>, x <span class="op">=</span> <span class="va">full</span><span class="op">$</span><span class="va">x</span>, xout <span class="op">=</span> <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">y</span>
<span class="va">cpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">g</span>, L <span class="op">=</span> <span class="va">L</span>, M <span class="op">=</span> <span class="va">M</span>, S <span class="op">=</span> <span class="va">S</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">cpt</span>, <span class="st">"study"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">full</span>, <span class="st">"study"</span><span class="op">)</span>
<span class="fu"><a href="../../reference/is_reference.html">is_reference</a></span><span class="op">(</span><span class="va">cpt</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Now let calculate fictitious measurements using both references, and compare the results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>z <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">2</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>
<span class="va">grid</span><span class="op">$</span><span class="va">yf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/z2y.html">z2y</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grid</span><span class="op">$</span><span class="va">x</span>, z <span class="op">=</span> <span class="va">grid</span><span class="op">$</span><span class="va">z</span>, ref <span class="op">=</span> <span class="va">full</span><span class="op">)</span>
<span class="va">grid</span><span class="op">$</span><span class="va">yc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/z2y.html">z2y</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grid</span><span class="op">$</span><span class="va">x</span>, z <span class="op">=</span> <span class="va">grid</span><span class="op">$</span><span class="va">z</span>, ref <span class="op">=</span> <span class="va">cpt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">yf</span> <span class="op">-</span> <span class="va">yc</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="compact_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The figure shows that the reculculate heights hoover around zero, as expected. Correspondence in the first two years is very good. The age 2 and 5 years are points at which different references have been combined. Age those ages the difference can be up to 3mm. It would be desirable if all differences would be within a range of, say, 1 mm. In order to achieve this, we need to more dense age grid.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stef van Buuren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
